{"ast":null,"code":"import \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport * as util from './core/util.js';\nimport timsort from './core/timsort.js';\nimport { REDRAW_BIT } from './graphic/constants.js';\nvar invalidZErrorLogged = false;\n\nfunction logInvalidZError() {\n  if (invalidZErrorLogged) {\n    return;\n  }\n\n  invalidZErrorLogged = true;\n  console.warn('z / z2 / zlevel of displayable is invalid, which may cause unexpected errors');\n}\n\nfunction shapeCompareFunc(a, b) {\n  if (a.zlevel === b.zlevel) {\n    if (a.z === b.z) {\n      return a.z2 - b.z2;\n    }\n\n    return a.z - b.z;\n  }\n\n  return a.zlevel - b.zlevel;\n}\n\nvar Storage = function () {\n  function Storage() {\n    this._roots = [];\n    this._displayList = [];\n    this._displayListLen = 0;\n    this.displayableSortFunc = shapeCompareFunc;\n  }\n\n  Storage.prototype.traverse = function (cb, context) {\n    for (var i = 0; i < this._roots.length; i++) {\n      this._roots[i].traverse(cb, context);\n    }\n  };\n\n  Storage.prototype.getDisplayList = function (update, includeIgnore) {\n    includeIgnore = includeIgnore || false;\n    var displayList = this._displayList;\n\n    if (update || !displayList.length) {\n      this.updateDisplayList(includeIgnore);\n    }\n\n    return displayList;\n  };\n\n  Storage.prototype.updateDisplayList = function (includeIgnore) {\n    this._displayListLen = 0;\n    var roots = this._roots;\n    var displayList = this._displayList;\n\n    for (var i = 0, len = roots.length; i < len; i++) {\n      this._updateAndAddDisplayable(roots[i], null, includeIgnore);\n    }\n\n    displayList.length = this._displayListLen;\n    timsort(displayList, shapeCompareFunc);\n  };\n\n  Storage.prototype._updateAndAddDisplayable = function (el, clipPaths, includeIgnore) {\n    if (el.ignore && !includeIgnore) {\n      return;\n    }\n\n    el.beforeUpdate();\n    el.update();\n    el.afterUpdate();\n    var userSetClipPath = el.getClipPath();\n\n    if (el.ignoreClip) {\n      clipPaths = null;\n    } else if (userSetClipPath) {\n      if (clipPaths) {\n        clipPaths = clipPaths.slice();\n      } else {\n        clipPaths = [];\n      }\n\n      var currentClipPath = userSetClipPath;\n      var parentClipPath = el;\n\n      while (currentClipPath) {\n        currentClipPath.parent = parentClipPath;\n        currentClipPath.updateTransform();\n        clipPaths.push(currentClipPath);\n        parentClipPath = currentClipPath;\n        currentClipPath = currentClipPath.getClipPath();\n      }\n    }\n\n    if (el.childrenRef) {\n      var children = el.childrenRef();\n\n      for (var i = 0; i < children.length; i++) {\n        var child = children[i];\n\n        if (el.__dirty) {\n          child.__dirty |= REDRAW_BIT;\n        }\n\n        this._updateAndAddDisplayable(child, clipPaths, includeIgnore);\n      }\n\n      el.__dirty = 0;\n    } else {\n      var disp = el;\n\n      if (clipPaths && clipPaths.length) {\n        disp.__clipPaths = clipPaths;\n      } else if (disp.__clipPaths && disp.__clipPaths.length > 0) {\n        disp.__clipPaths = [];\n      }\n\n      if (isNaN(disp.z)) {\n        logInvalidZError();\n        disp.z = 0;\n      }\n\n      if (isNaN(disp.z2)) {\n        logInvalidZError();\n        disp.z2 = 0;\n      }\n\n      if (isNaN(disp.zlevel)) {\n        logInvalidZError();\n        disp.zlevel = 0;\n      }\n\n      this._displayList[this._displayListLen++] = disp;\n    }\n\n    var decalEl = el.getDecalElement && el.getDecalElement();\n\n    if (decalEl) {\n      this._updateAndAddDisplayable(decalEl, clipPaths, includeIgnore);\n    }\n\n    var textGuide = el.getTextGuideLine();\n\n    if (textGuide) {\n      this._updateAndAddDisplayable(textGuide, clipPaths, includeIgnore);\n    }\n\n    var textEl = el.getTextContent();\n\n    if (textEl) {\n      this._updateAndAddDisplayable(textEl, clipPaths, includeIgnore);\n    }\n  };\n\n  Storage.prototype.addRoot = function (el) {\n    if (el.__zr && el.__zr.storage === this) {\n      return;\n    }\n\n    this._roots.push(el);\n  };\n\n  Storage.prototype.delRoot = function (el) {\n    if (el instanceof Array) {\n      for (var i = 0, l = el.length; i < l; i++) {\n        this.delRoot(el[i]);\n      }\n\n      return;\n    }\n\n    var idx = util.indexOf(this._roots, el);\n\n    if (idx >= 0) {\n      this._roots.splice(idx, 1);\n    }\n  };\n\n  Storage.prototype.delAllRoots = function () {\n    this._roots = [];\n    this._displayList = [];\n    this._displayListLen = 0;\n    return;\n  };\n\n  Storage.prototype.getRoots = function () {\n    return this._roots;\n  };\n\n  Storage.prototype.dispose = function () {\n    this._displayList = null;\n    this._roots = null;\n  };\n\n  return Storage;\n}();\n\nexport default Storage;","map":{"version":3,"sources":["/home/rayce/Udatabase/study/ElectronicMall/BookVue/node_modules/zrender/lib/Storage.js"],"names":["util","timsort","REDRAW_BIT","invalidZErrorLogged","logInvalidZError","console","warn","shapeCompareFunc","a","b","zlevel","z","z2","Storage","_roots","_displayList","_displayListLen","displayableSortFunc","prototype","traverse","cb","context","i","length","getDisplayList","update","includeIgnore","displayList","updateDisplayList","roots","len","_updateAndAddDisplayable","el","clipPaths","ignore","beforeUpdate","afterUpdate","userSetClipPath","getClipPath","ignoreClip","slice","currentClipPath","parentClipPath","parent","updateTransform","push","childrenRef","children","child","__dirty","disp","__clipPaths","isNaN","decalEl","getDecalElement","textGuide","getTextGuideLine","textEl","getTextContent","addRoot","__zr","storage","delRoot","Array","l","idx","indexOf","splice","delAllRoots","getRoots","dispose"],"mappings":"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","sourcesContent":["import * as util from './core/util.js';\nimport timsort from './core/timsort.js';\nimport { REDRAW_BIT } from './graphic/constants.js';\nvar invalidZErrorLogged = false;\nfunction logInvalidZError() {\n    if (invalidZErrorLogged) {\n        return;\n    }\n    invalidZErrorLogged = true;\n    console.warn('z / z2 / zlevel of displayable is invalid, which may cause unexpected errors');\n}\nfunction shapeCompareFunc(a, b) {\n    if (a.zlevel === b.zlevel) {\n        if (a.z === b.z) {\n            return a.z2 - b.z2;\n        }\n        return a.z - b.z;\n    }\n    return a.zlevel - b.zlevel;\n}\nvar Storage = (function () {\n    function Storage() {\n        this._roots = [];\n        this._displayList = [];\n        this._displayListLen = 0;\n        this.displayableSortFunc = shapeCompareFunc;\n    }\n    Storage.prototype.traverse = function (cb, context) {\n        for (var i = 0; i < this._roots.length; i++) {\n            this._roots[i].traverse(cb, context);\n        }\n    };\n    Storage.prototype.getDisplayList = function (update, includeIgnore) {\n        includeIgnore = includeIgnore || false;\n        var displayList = this._displayList;\n        if (update || !displayList.length) {\n            this.updateDisplayList(includeIgnore);\n        }\n        return displayList;\n    };\n    Storage.prototype.updateDisplayList = function (includeIgnore) {\n        this._displayListLen = 0;\n        var roots = this._roots;\n        var displayList = this._displayList;\n        for (var i = 0, len = roots.length; i < len; i++) {\n            this._updateAndAddDisplayable(roots[i], null, includeIgnore);\n        }\n        displayList.length = this._displayListLen;\n        timsort(displayList, shapeCompareFunc);\n    };\n    Storage.prototype._updateAndAddDisplayable = function (el, clipPaths, includeIgnore) {\n        if (el.ignore && !includeIgnore) {\n            return;\n        }\n        el.beforeUpdate();\n        el.update();\n        el.afterUpdate();\n        var userSetClipPath = el.getClipPath();\n        if (el.ignoreClip) {\n            clipPaths = null;\n        }\n        else if (userSetClipPath) {\n            if (clipPaths) {\n                clipPaths = clipPaths.slice();\n            }\n            else {\n                clipPaths = [];\n            }\n            var currentClipPath = userSetClipPath;\n            var parentClipPath = el;\n            while (currentClipPath) {\n                currentClipPath.parent = parentClipPath;\n                currentClipPath.updateTransform();\n                clipPaths.push(currentClipPath);\n                parentClipPath = currentClipPath;\n                currentClipPath = currentClipPath.getClipPath();\n            }\n        }\n        if (el.childrenRef) {\n            var children = el.childrenRef();\n            for (var i = 0; i < children.length; i++) {\n                var child = children[i];\n                if (el.__dirty) {\n                    child.__dirty |= REDRAW_BIT;\n                }\n                this._updateAndAddDisplayable(child, clipPaths, includeIgnore);\n            }\n            el.__dirty = 0;\n        }\n        else {\n            var disp = el;\n            if (clipPaths && clipPaths.length) {\n                disp.__clipPaths = clipPaths;\n            }\n            else if (disp.__clipPaths && disp.__clipPaths.length > 0) {\n                disp.__clipPaths = [];\n            }\n            if (isNaN(disp.z)) {\n                logInvalidZError();\n                disp.z = 0;\n            }\n            if (isNaN(disp.z2)) {\n                logInvalidZError();\n                disp.z2 = 0;\n            }\n            if (isNaN(disp.zlevel)) {\n                logInvalidZError();\n                disp.zlevel = 0;\n            }\n            this._displayList[this._displayListLen++] = disp;\n        }\n        var decalEl = el.getDecalElement && el.getDecalElement();\n        if (decalEl) {\n            this._updateAndAddDisplayable(decalEl, clipPaths, includeIgnore);\n        }\n        var textGuide = el.getTextGuideLine();\n        if (textGuide) {\n            this._updateAndAddDisplayable(textGuide, clipPaths, includeIgnore);\n        }\n        var textEl = el.getTextContent();\n        if (textEl) {\n            this._updateAndAddDisplayable(textEl, clipPaths, includeIgnore);\n        }\n    };\n    Storage.prototype.addRoot = function (el) {\n        if (el.__zr && el.__zr.storage === this) {\n            return;\n        }\n        this._roots.push(el);\n    };\n    Storage.prototype.delRoot = function (el) {\n        if (el instanceof Array) {\n            for (var i = 0, l = el.length; i < l; i++) {\n                this.delRoot(el[i]);\n            }\n            return;\n        }\n        var idx = util.indexOf(this._roots, el);\n        if (idx >= 0) {\n            this._roots.splice(idx, 1);\n        }\n    };\n    Storage.prototype.delAllRoots = function () {\n        this._roots = [];\n        this._displayList = [];\n        this._displayListLen = 0;\n        return;\n    };\n    Storage.prototype.getRoots = function () {\n        return this._roots;\n    };\n    Storage.prototype.dispose = function () {\n        this._displayList = null;\n        this._roots = null;\n    };\n    return Storage;\n}());\nexport default Storage;\n"]},"metadata":{},"sourceType":"module"}
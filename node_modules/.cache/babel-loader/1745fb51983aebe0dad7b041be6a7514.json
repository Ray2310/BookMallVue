{"ast":null,"code":"import \"core-js/modules/es.array.concat.js\";\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport * as modelUtil from '../../util/model.js';\nimport ComponentModel from '../../model/Component.js';\nimport { copyLayoutParams, mergeLayoutParam } from '../../util/layout.js';\n;\n;\n;\nexport function setKeyInfoToNewElOption(resultItem, newElOption) {\n  var existElOption = resultItem.existing; // Set id and type after id assigned.\n\n  newElOption.id = resultItem.keyInfo.id;\n  !newElOption.type && existElOption && (newElOption.type = existElOption.type); // Set parent id if not specified\n\n  if (newElOption.parentId == null) {\n    var newElParentOption = newElOption.parentOption;\n\n    if (newElParentOption) {\n      newElOption.parentId = newElParentOption.id;\n    } else if (existElOption) {\n      newElOption.parentId = existElOption.parentId;\n    }\n  } // Clear\n\n\n  newElOption.parentOption = null;\n}\n\nfunction isSetLoc(obj, props) {\n  var isSet;\n  zrUtil.each(props, function (prop) {\n    obj[prop] != null && obj[prop] !== 'auto' && (isSet = true);\n  });\n  return isSet;\n}\n\nfunction mergeNewElOptionToExist(existList, index, newElOption) {\n  // Update existing options, for `getOption` feature.\n  var newElOptCopy = zrUtil.extend({}, newElOption);\n  var existElOption = existList[index];\n  var $action = newElOption.$action || 'merge';\n\n  if ($action === 'merge') {\n    if (existElOption) {\n      if (process.env.NODE_ENV !== 'production') {\n        var newType = newElOption.type;\n        zrUtil.assert(!newType || existElOption.type === newType, 'Please set $action: \"replace\" to change `type`');\n      } // We can ensure that newElOptCopy and existElOption are not\n      // the same object, so `merge` will not change newElOptCopy.\n\n\n      zrUtil.merge(existElOption, newElOptCopy, true); // Rigid body, use ignoreSize.\n\n      mergeLayoutParam(existElOption, newElOptCopy, {\n        ignoreSize: true\n      }); // Will be used in render.\n\n      copyLayoutParams(newElOption, existElOption); // Copy transition info to new option so it can be used in the transition.\n      // DO IT AFTER merge\n\n      copyTransitionInfo(newElOption, existElOption);\n      copyTransitionInfo(newElOption, existElOption, 'shape');\n      copyTransitionInfo(newElOption, existElOption, 'style');\n      copyTransitionInfo(newElOption, existElOption, 'extra'); // Copy clipPath\n\n      newElOption.clipPath = existElOption.clipPath;\n    } else {\n      existList[index] = newElOptCopy;\n    }\n  } else if ($action === 'replace') {\n    existList[index] = newElOptCopy;\n  } else if ($action === 'remove') {\n    // null will be cleaned later.\n    existElOption && (existList[index] = null);\n  }\n}\n\nvar TRANSITION_PROPS_TO_COPY = ['transition', 'enterFrom', 'leaveTo'];\nvar ROOT_TRANSITION_PROPS_TO_COPY = TRANSITION_PROPS_TO_COPY.concat(['enterAnimation', 'updateAnimation', 'leaveAnimation']);\n\nfunction copyTransitionInfo(target, source, targetProp) {\n  if (targetProp) {\n    if (!target[targetProp] && source[targetProp]) {\n      // TODO avoid creating this empty object when there is no transition configuration.\n      target[targetProp] = {};\n    }\n\n    target = target[targetProp];\n    source = source[targetProp];\n  }\n\n  if (!target || !source) {\n    return;\n  }\n\n  var props = targetProp ? TRANSITION_PROPS_TO_COPY : ROOT_TRANSITION_PROPS_TO_COPY;\n\n  for (var i = 0; i < props.length; i++) {\n    var prop = props[i];\n\n    if (target[prop] == null && source[prop] != null) {\n      target[prop] = source[prop];\n    }\n  }\n}\n\nfunction setLayoutInfoToExist(existItem, newElOption) {\n  if (!existItem) {\n    return;\n  }\n\n  existItem.hv = newElOption.hv = [// Rigid body, don't care about `width`.\n  isSetLoc(newElOption, ['left', 'right']), // Rigid body, don't care about `height`.\n  isSetLoc(newElOption, ['top', 'bottom'])]; // Give default group size. Otherwise layout error may occur.\n\n  if (existItem.type === 'group') {\n    var existingGroupOpt = existItem;\n    var newGroupOpt = newElOption;\n    existingGroupOpt.width == null && (existingGroupOpt.width = newGroupOpt.width = 0);\n    existingGroupOpt.height == null && (existingGroupOpt.height = newGroupOpt.height = 0);\n  }\n}\n\nvar GraphicComponentModel =\n/** @class */\nfunction (_super) {\n  __extends(GraphicComponentModel, _super);\n\n  function GraphicComponentModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = GraphicComponentModel.type;\n    _this.preventAutoZ = true;\n    return _this;\n  }\n\n  GraphicComponentModel.prototype.mergeOption = function (option, ecModel) {\n    // Prevent default merge to elements\n    var elements = this.option.elements;\n    this.option.elements = null;\n\n    _super.prototype.mergeOption.call(this, option, ecModel);\n\n    this.option.elements = elements;\n  };\n\n  GraphicComponentModel.prototype.optionUpdated = function (newOption, isInit) {\n    var thisOption = this.option;\n    var newList = (isInit ? thisOption : newOption).elements;\n    var existList = thisOption.elements = isInit ? [] : thisOption.elements;\n    var flattenedList = [];\n\n    this._flatten(newList, flattenedList, null);\n\n    var mappingResult = modelUtil.mappingToExists(existList, flattenedList, 'normalMerge'); // Clear elOptionsToUpdate\n\n    var elOptionsToUpdate = this._elOptionsToUpdate = [];\n    zrUtil.each(mappingResult, function (resultItem, index) {\n      var newElOption = resultItem.newOption;\n\n      if (process.env.NODE_ENV !== 'production') {\n        zrUtil.assert(zrUtil.isObject(newElOption) || resultItem.existing, 'Empty graphic option definition');\n      }\n\n      if (!newElOption) {\n        return;\n      }\n\n      elOptionsToUpdate.push(newElOption);\n      setKeyInfoToNewElOption(resultItem, newElOption);\n      mergeNewElOptionToExist(existList, index, newElOption);\n      setLayoutInfoToExist(existList[index], newElOption);\n    }, this); // Clean\n\n    thisOption.elements = zrUtil.filter(existList, function (item) {\n      // $action should be volatile, otherwise option gotten from\n      // `getOption` will contain unexpected $action.\n      item && delete item.$action;\n      return item != null;\n    });\n  };\n  /**\n   * Convert\n   * [{\n   *  type: 'group',\n   *  id: 'xx',\n   *  children: [{type: 'circle'}, {type: 'polygon'}]\n   * }]\n   * to\n   * [\n   *  {type: 'group', id: 'xx'},\n   *  {type: 'circle', parentId: 'xx'},\n   *  {type: 'polygon', parentId: 'xx'}\n   * ]\n   */\n\n\n  GraphicComponentModel.prototype._flatten = function (optionList, result, parentOption) {\n    zrUtil.each(optionList, function (option) {\n      if (!option) {\n        return;\n      }\n\n      if (parentOption) {\n        option.parentOption = parentOption;\n      }\n\n      result.push(option);\n      var children = option.children; // here we don't judge if option.type is `group`\n      // when new option doesn't provide `type`, it will cause that the children can't be updated.\n\n      if (children && children.length) {\n        this._flatten(children, result, option);\n      } // Deleting for JSON output, and for not affecting group creation.\n\n\n      delete option.children;\n    }, this);\n  }; // FIXME\n  // Pass to view using payload? setOption has a payload?\n\n\n  GraphicComponentModel.prototype.useElOptionsToUpdate = function () {\n    var els = this._elOptionsToUpdate; // Clear to avoid render duplicately when zooming.\n\n    this._elOptionsToUpdate = null;\n    return els;\n  };\n\n  GraphicComponentModel.type = 'graphic';\n  GraphicComponentModel.defaultOption = {\n    elements: [] // parentId: null\n\n  };\n  return GraphicComponentModel;\n}(ComponentModel);\n\nexport { GraphicComponentModel };","map":{"version":3,"sources":["/home/rayce/Udatabase/study/ElectronicMall/BookVue/node_modules/echarts/lib/component/graphic/GraphicModel.js"],"names":["__extends","zrUtil","modelUtil","ComponentModel","copyLayoutParams","mergeLayoutParam","setKeyInfoToNewElOption","resultItem","newElOption","existElOption","existing","id","keyInfo","type","parentId","newElParentOption","parentOption","isSetLoc","obj","props","isSet","each","prop","mergeNewElOptionToExist","existList","index","newElOptCopy","extend","$action","process","env","NODE_ENV","newType","assert","merge","ignoreSize","copyTransitionInfo","clipPath","TRANSITION_PROPS_TO_COPY","ROOT_TRANSITION_PROPS_TO_COPY","concat","target","source","targetProp","i","length","setLayoutInfoToExist","existItem","hv","existingGroupOpt","newGroupOpt","width","height","GraphicComponentModel","_super","_this","apply","arguments","preventAutoZ","prototype","mergeOption","option","ecModel","elements","call","optionUpdated","newOption","isInit","thisOption","newList","flattenedList","_flatten","mappingResult","mappingToExists","elOptionsToUpdate","_elOptionsToUpdate","isObject","push","filter","item","optionList","result","children","useElOptionsToUpdate","els","defaultOption"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport * as modelUtil from '../../util/model.js';\nimport ComponentModel from '../../model/Component.js';\nimport { copyLayoutParams, mergeLayoutParam } from '../../util/layout.js';\n;\n;\n;\nexport function setKeyInfoToNewElOption(resultItem, newElOption) {\n  var existElOption = resultItem.existing; // Set id and type after id assigned.\n\n  newElOption.id = resultItem.keyInfo.id;\n  !newElOption.type && existElOption && (newElOption.type = existElOption.type); // Set parent id if not specified\n\n  if (newElOption.parentId == null) {\n    var newElParentOption = newElOption.parentOption;\n\n    if (newElParentOption) {\n      newElOption.parentId = newElParentOption.id;\n    } else if (existElOption) {\n      newElOption.parentId = existElOption.parentId;\n    }\n  } // Clear\n\n\n  newElOption.parentOption = null;\n}\n\nfunction isSetLoc(obj, props) {\n  var isSet;\n  zrUtil.each(props, function (prop) {\n    obj[prop] != null && obj[prop] !== 'auto' && (isSet = true);\n  });\n  return isSet;\n}\n\nfunction mergeNewElOptionToExist(existList, index, newElOption) {\n  // Update existing options, for `getOption` feature.\n  var newElOptCopy = zrUtil.extend({}, newElOption);\n  var existElOption = existList[index];\n  var $action = newElOption.$action || 'merge';\n\n  if ($action === 'merge') {\n    if (existElOption) {\n      if (process.env.NODE_ENV !== 'production') {\n        var newType = newElOption.type;\n        zrUtil.assert(!newType || existElOption.type === newType, 'Please set $action: \"replace\" to change `type`');\n      } // We can ensure that newElOptCopy and existElOption are not\n      // the same object, so `merge` will not change newElOptCopy.\n\n\n      zrUtil.merge(existElOption, newElOptCopy, true); // Rigid body, use ignoreSize.\n\n      mergeLayoutParam(existElOption, newElOptCopy, {\n        ignoreSize: true\n      }); // Will be used in render.\n\n      copyLayoutParams(newElOption, existElOption); // Copy transition info to new option so it can be used in the transition.\n      // DO IT AFTER merge\n\n      copyTransitionInfo(newElOption, existElOption);\n      copyTransitionInfo(newElOption, existElOption, 'shape');\n      copyTransitionInfo(newElOption, existElOption, 'style');\n      copyTransitionInfo(newElOption, existElOption, 'extra'); // Copy clipPath\n\n      newElOption.clipPath = existElOption.clipPath;\n    } else {\n      existList[index] = newElOptCopy;\n    }\n  } else if ($action === 'replace') {\n    existList[index] = newElOptCopy;\n  } else if ($action === 'remove') {\n    // null will be cleaned later.\n    existElOption && (existList[index] = null);\n  }\n}\n\nvar TRANSITION_PROPS_TO_COPY = ['transition', 'enterFrom', 'leaveTo'];\nvar ROOT_TRANSITION_PROPS_TO_COPY = TRANSITION_PROPS_TO_COPY.concat(['enterAnimation', 'updateAnimation', 'leaveAnimation']);\n\nfunction copyTransitionInfo(target, source, targetProp) {\n  if (targetProp) {\n    if (!target[targetProp] && source[targetProp]) {\n      // TODO avoid creating this empty object when there is no transition configuration.\n      target[targetProp] = {};\n    }\n\n    target = target[targetProp];\n    source = source[targetProp];\n  }\n\n  if (!target || !source) {\n    return;\n  }\n\n  var props = targetProp ? TRANSITION_PROPS_TO_COPY : ROOT_TRANSITION_PROPS_TO_COPY;\n\n  for (var i = 0; i < props.length; i++) {\n    var prop = props[i];\n\n    if (target[prop] == null && source[prop] != null) {\n      target[prop] = source[prop];\n    }\n  }\n}\n\nfunction setLayoutInfoToExist(existItem, newElOption) {\n  if (!existItem) {\n    return;\n  }\n\n  existItem.hv = newElOption.hv = [// Rigid body, don't care about `width`.\n  isSetLoc(newElOption, ['left', 'right']), // Rigid body, don't care about `height`.\n  isSetLoc(newElOption, ['top', 'bottom'])]; // Give default group size. Otherwise layout error may occur.\n\n  if (existItem.type === 'group') {\n    var existingGroupOpt = existItem;\n    var newGroupOpt = newElOption;\n    existingGroupOpt.width == null && (existingGroupOpt.width = newGroupOpt.width = 0);\n    existingGroupOpt.height == null && (existingGroupOpt.height = newGroupOpt.height = 0);\n  }\n}\n\nvar GraphicComponentModel =\n/** @class */\nfunction (_super) {\n  __extends(GraphicComponentModel, _super);\n\n  function GraphicComponentModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = GraphicComponentModel.type;\n    _this.preventAutoZ = true;\n    return _this;\n  }\n\n  GraphicComponentModel.prototype.mergeOption = function (option, ecModel) {\n    // Prevent default merge to elements\n    var elements = this.option.elements;\n    this.option.elements = null;\n\n    _super.prototype.mergeOption.call(this, option, ecModel);\n\n    this.option.elements = elements;\n  };\n\n  GraphicComponentModel.prototype.optionUpdated = function (newOption, isInit) {\n    var thisOption = this.option;\n    var newList = (isInit ? thisOption : newOption).elements;\n    var existList = thisOption.elements = isInit ? [] : thisOption.elements;\n    var flattenedList = [];\n\n    this._flatten(newList, flattenedList, null);\n\n    var mappingResult = modelUtil.mappingToExists(existList, flattenedList, 'normalMerge'); // Clear elOptionsToUpdate\n\n    var elOptionsToUpdate = this._elOptionsToUpdate = [];\n    zrUtil.each(mappingResult, function (resultItem, index) {\n      var newElOption = resultItem.newOption;\n\n      if (process.env.NODE_ENV !== 'production') {\n        zrUtil.assert(zrUtil.isObject(newElOption) || resultItem.existing, 'Empty graphic option definition');\n      }\n\n      if (!newElOption) {\n        return;\n      }\n\n      elOptionsToUpdate.push(newElOption);\n      setKeyInfoToNewElOption(resultItem, newElOption);\n      mergeNewElOptionToExist(existList, index, newElOption);\n      setLayoutInfoToExist(existList[index], newElOption);\n    }, this); // Clean\n\n    thisOption.elements = zrUtil.filter(existList, function (item) {\n      // $action should be volatile, otherwise option gotten from\n      // `getOption` will contain unexpected $action.\n      item && delete item.$action;\n      return item != null;\n    });\n  };\n  /**\n   * Convert\n   * [{\n   *  type: 'group',\n   *  id: 'xx',\n   *  children: [{type: 'circle'}, {type: 'polygon'}]\n   * }]\n   * to\n   * [\n   *  {type: 'group', id: 'xx'},\n   *  {type: 'circle', parentId: 'xx'},\n   *  {type: 'polygon', parentId: 'xx'}\n   * ]\n   */\n\n\n  GraphicComponentModel.prototype._flatten = function (optionList, result, parentOption) {\n    zrUtil.each(optionList, function (option) {\n      if (!option) {\n        return;\n      }\n\n      if (parentOption) {\n        option.parentOption = parentOption;\n      }\n\n      result.push(option);\n      var children = option.children; // here we don't judge if option.type is `group`\n      // when new option doesn't provide `type`, it will cause that the children can't be updated.\n\n      if (children && children.length) {\n        this._flatten(children, result, option);\n      } // Deleting for JSON output, and for not affecting group creation.\n\n\n      delete option.children;\n    }, this);\n  }; // FIXME\n  // Pass to view using payload? setOption has a payload?\n\n\n  GraphicComponentModel.prototype.useElOptionsToUpdate = function () {\n    var els = this._elOptionsToUpdate; // Clear to avoid render duplicately when zooming.\n\n    this._elOptionsToUpdate = null;\n    return els;\n  };\n\n  GraphicComponentModel.type = 'graphic';\n  GraphicComponentModel.defaultOption = {\n    elements: [] // parentId: null\n\n  };\n  return GraphicComponentModel;\n}(ComponentModel);\n\nexport { GraphicComponentModel };"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"core-js/modules/es.array.splice.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport MessageItem from \"@/components/MessageItem\";\nvar url = \"/api/market\";\nexport default {\n  name: \"MarketGoodView\",\n  data: function data() {\n    return {\n      baseApi: this.$store.state.baseApi,\n      userId: 0,\n      goodId: 0,\n      good: {},\n      inputMessage: '',\n      messages: []\n    };\n  },\n  components: {\n    'message-item': MessageItem\n  },\n  created: function created() {\n    var _this = this;\n\n    this.goodId = this.$route.params.goodId;\n    this.request.get(\"/userid\").then(function (res) {\n      _this.userId = res;\n    }); //获取商品信息\n\n    this.request.get(url + \"/good/\" + this.goodId).then(function (res) {\n      if (res.code === '200') {\n        _this.good = res.data;\n      }\n    }); //获取留言\n\n    this.loadMessage();\n  },\n  methods: {\n    //发送留言\n    sendMessage: function sendMessage() {\n      var _this2 = this;\n\n      if (this.inputMessage === '') {\n        this.$message.error(\"不能为空！\");\n        return false;\n      }\n\n      this.request.get(\"/userid\").then(function (res) {\n        _this2.userId = res;\n\n        _this2.request.post(url + \"/message\", {\n          goodId: _this2.goodId,\n          userId: _this2.userId,\n          message: _this2.inputMessage\n        }).then(function (res) {\n          if (res.code === '200') {\n            _this2.$message.success(\"留言成功！\");\n\n            _this2.inputMessage = '';\n\n            _this2.loadMessage();\n          } else {\n            _this2.$message.error(\"留言失败\");\n          }\n        });\n      });\n    },\n    delMessage: function delMessage(index) {\n      console.log(index);\n      this.messages.splice(index, 1);\n    },\n    loadMessage: function loadMessage() {\n      var _this3 = this;\n\n      this.request.get(url + \"/message/\" + this.goodId).then(function (res) {\n        if (res.code === '200') {\n          _this3.messages = res.data;\n          console.log(_this3.messages);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACAA,wBADA;AAEAC,MAFA,kBAEA;AACA;AACAC,wCADA;AAEAC,eAFA;AAGAC,eAHA;AAIAC,cAJA;AAKAC,sBALA;AAMAC;AANA;AAQA,GAXA;AAYAC;AACA;AADA,GAZA;AAeAC,SAfA,qBAeA;AAAA;;AACA;AACA;AACA;AACA,KAFA,EAFA,CAKA;;AACA;AACA;AACA;AACA;AACA,KAJA,EANA,CAWA;;AACA;AACA,GA5BA;AA6BAC;AACA;AACAC,eAFA,yBAEA;AAAA;;AACA;AACA;AACA;AACA;;AACA;AACA;;AACA;AACAP,+BADA;AAEAD,+BAFA;AAGAS;AAHA,WAIAC,IAJA,CAIA;AACA;AACA;;AACA;;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA,SAZA;AAaA,OAfA;AAgBA,KAvBA;AAwBAC,cAxBA,sBAwBAC,KAxBA,EAwBA;AACAC;AACA;AACA,KA3BA;AA4BAC,eA5BA,yBA4BA;AAAA;;AACA;AACA;AACA;AACAD;AACA;AACA,OALA;AAMA;AAnCA;AA7BA","names":["name","data","baseApi","userId","goodId","good","inputMessage","messages","components","created","methods","sendMessage","message","then","delMessage","index","console","loadMessage"],"sourceRoot":"src/views/front/market","sources":["MarketGoodView.vue"],"sourcesContent":["<template>\r\n  <div class=\"main-box\">\r\n    <div>\r\n      <!--    左侧的图片-->\r\n      <div class=\"image-box\">\r\n        <img :src=\"baseApi + good.img\" class=\"image\">\r\n      </div>\r\n      <!--    右侧盒子-->\r\n      <div class=\"detail-box\">\r\n\r\n\r\n        <div class=\"price-box\">\r\n          <!--      商品名与描述-->\r\n          <div>\r\n            <span style=\"font-size: 22px\" ><strong>{{good.goodName}}</strong></span><br/>\r\n          </div>\r\n          <div style=\"margin-top: 16px\">\r\n            <span style=\"font-size: 17px;color: red\">{{good.description}}</span>\r\n          </div>\r\n          <!--      发布者信息-->\r\n          <div class=\"user-info\">\r\n            <span  >发布者昵称：</span>\r\n            <span style=\"color: #078275\">{{good.nickname}}</span><br/>\r\n            <span>发布者id：</span>\r\n            <span style=\"color: #078275\" >&nbsp;&nbsp;&nbsp;{{good.userId}}</span><br/>\r\n            <span>发布时间：</span>\r\n            <span style=\"color: #078275\" >&nbsp;&nbsp;&nbsp;{{good.createTime}}</span><br/>\r\n          </div>\r\n          <!--      价格-->\r\n          <div>  <dt>价格</dt>  <dd style=\"color: red;font-size: 25px\">  {{good.price}}元  </dd></div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n<!--    留言-->\r\n    <div class=\"message-box\">\r\n\r\n      <el-input\r\n          type=\"textarea\"\r\n          :rows=\"2\"\r\n          resize=\"none\"\r\n          placeholder=\"请输入留言\"\r\n          style=\"width: 90%;\"\r\n          v-model=\"inputMessage\">\r\n      </el-input>\r\n      <el-button class=\"message-button\" @click=\"sendMessage\">发送</el-button>\r\n      <message-item v-for=\"(message,index) in messages\"\r\n                    :message=\"message\"\r\n                    :userId=\"userId\"\r\n                    :index=\"index\"\r\n                    :key=\"message.id\"\r\n                    @del-message=\"delMessage\"\r\n                    style=\"margin: 20px 0\"></message-item>\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport MessageItem from \"@/components/MessageItem\";\r\nconst url = \"/api/market\"\r\nexport default {\r\n  name: \"MarketGoodView\",\r\n  data(){\r\n    return{\r\n      baseApi: this.$store.state.baseApi,\r\n      userId: 0,\r\n      goodId: 0,\r\n      good: {},\r\n      inputMessage: '',\r\n      messages:[],\r\n    }\r\n  },\r\n  components:{\r\n    'message-item': MessageItem,\r\n  },\r\n  created() {\r\n    this.goodId = this.$route.params.goodId;\r\n    this.request.get(\"/userid\").then(res=>{\r\n      this.userId = res;\r\n    })\r\n    //获取商品信息\r\n    this.request.get(url+\"/good/\"+this.goodId).then(res=>{\r\n      if(res.code==='200'){\r\n        this.good = res.data;\r\n      }\r\n    })\r\n    //获取留言\r\n      this.loadMessage();\r\n  },\r\n  methods:{\r\n    //发送留言\r\n    sendMessage(){\r\n      if(this.inputMessage===''){\r\n        this.$message.error(\"不能为空！\")\r\n        return false;\r\n      }\r\n      this.request.get(\"/userid\").then(res=>{\r\n          this.userId = res;\r\n          this.request.post(url+\"/message\",{\r\n            goodId: this.goodId,\r\n            userId: this.userId,\r\n            message: this.inputMessage\r\n          }).then(res=>{\r\n            if(res.code==='200'){\r\n              this.$message.success(\"留言成功！\")\r\n              this.inputMessage = '';\r\n              this.loadMessage();\r\n            }else{\r\n              this.$message.error(\"留言失败\")\r\n            }\r\n          })\r\n      })\r\n    },\r\n    delMessage(index){\r\n      console.log(index)\r\n      this.messages.splice(index,1)\r\n    },\r\n    loadMessage(){\r\n      this.request.get(url+\"/message/\"+this.goodId).then(res=>{\r\n        if(res.code==='200'){\r\n          this.messages = res.data;\r\n          console.log(this.messages)\r\n        }\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.main-box {\r\n  width: 1060px;\r\n  margin: 20px auto;\r\n  padding: 30px;\r\n  background-color: #ffffff;\r\n  overflow: hidden;\r\n}\r\n.image-box{\r\n  height: 420px;\r\n  width: 420px;\r\n  border: #f2f2f2 1px solid;\r\n  text-align: center;\r\n  margin-left: 80px;\r\n  margin-top: 30px;\r\n  display: inline-block;\r\n  overflow: hidden;\r\n}\r\n.image{\r\n  height: 100%;\r\n  width: 350px;\r\n}\r\n.detail-box{\r\n  height: 420px;\r\n  width: 400px;\r\n  display: inline-block;\r\n  margin-left: 50px;\r\n  overflow: hidden;\r\n}\r\n.price-box{\r\n  background-color: #e9e9e9;\r\n  background-image: linear-gradient(to top right, #e3fafa, rgba(159, 250, 246, 0.56));\r\n  border-radius: 5px;\r\n  font: 12px/1.5 \"Microsoft Yahei\",tahoma,arial;\r\n  padding: 30px;\r\n  margin-right: 20px;\r\n  margin-top: 30px;\r\n}\r\n.price-box div{\r\n  line-height: 20px;\r\n  margin-left: 8px;\r\n  margin-bottom: 18px;\r\n}\r\n.price-box dt{\r\n  float: left;\r\n  font-size: 16px;\r\n  line-height: 20px;\r\n}\r\n.price-box dd{\r\n  font-size: 18px;\r\n  line-height: 20px;\r\n}\r\n.user-info span{\r\n  font-size: 18px;\r\n}\r\n.message-button{\r\n  width: 8%;\r\n  height: 54px;\r\n  margin-left: 10px;\r\n  background-color: #64c7ee;\r\n  color: white;\r\n}\r\n.message-box{\r\n  width: 85%;\r\n  margin: 30px auto;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}
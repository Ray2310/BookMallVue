{"ast":null,"code":"import { __extends } from \"tslib\";\nimport Eventful from '../core/Eventful.js';\nimport requestAnimationFrame from './requestAnimationFrame.js';\nimport Animator from './Animator.js';\nexport function getTime() {\n  return new Date().getTime();\n}\n\nvar Animation = function (_super) {\n  __extends(Animation, _super);\n\n  function Animation(opts) {\n    var _this = _super.call(this) || this;\n\n    _this._running = false;\n    _this._time = 0;\n    _this._pausedTime = 0;\n    _this._pauseStart = 0;\n    _this._paused = false;\n    opts = opts || {};\n    _this.stage = opts.stage || {};\n    return _this;\n  }\n\n  Animation.prototype.addClip = function (clip) {\n    if (clip.animation) {\n      this.removeClip(clip);\n    }\n\n    if (!this._head) {\n      this._head = this._tail = clip;\n    } else {\n      this._tail.next = clip;\n      clip.prev = this._tail;\n      clip.next = null;\n      this._tail = clip;\n    }\n\n    clip.animation = this;\n  };\n\n  Animation.prototype.addAnimator = function (animator) {\n    animator.animation = this;\n    var clip = animator.getClip();\n\n    if (clip) {\n      this.addClip(clip);\n    }\n  };\n\n  Animation.prototype.removeClip = function (clip) {\n    if (!clip.animation) {\n      return;\n    }\n\n    var prev = clip.prev;\n    var next = clip.next;\n\n    if (prev) {\n      prev.next = next;\n    } else {\n      this._head = next;\n    }\n\n    if (next) {\n      next.prev = prev;\n    } else {\n      this._tail = prev;\n    }\n\n    clip.next = clip.prev = clip.animation = null;\n  };\n\n  Animation.prototype.removeAnimator = function (animator) {\n    var clip = animator.getClip();\n\n    if (clip) {\n      this.removeClip(clip);\n    }\n\n    animator.animation = null;\n  };\n\n  Animation.prototype.update = function (notTriggerFrameAndStageUpdate) {\n    var time = getTime() - this._pausedTime;\n\n    var delta = time - this._time;\n    var clip = this._head;\n\n    while (clip) {\n      var nextClip = clip.next;\n      var finished = clip.step(time, delta);\n\n      if (finished) {\n        clip.ondestroy();\n        this.removeClip(clip);\n        clip = nextClip;\n      } else {\n        clip = nextClip;\n      }\n    }\n\n    this._time = time;\n\n    if (!notTriggerFrameAndStageUpdate) {\n      this.trigger('frame', delta);\n      this.stage.update && this.stage.update();\n    }\n  };\n\n  Animation.prototype._startLoop = function () {\n    var self = this;\n    this._running = true;\n\n    function step() {\n      if (self._running) {\n        requestAnimationFrame(step);\n        !self._paused && self.update();\n      }\n    }\n\n    requestAnimationFrame(step);\n  };\n\n  Animation.prototype.start = function () {\n    if (this._running) {\n      return;\n    }\n\n    this._time = getTime();\n    this._pausedTime = 0;\n\n    this._startLoop();\n  };\n\n  Animation.prototype.stop = function () {\n    this._running = false;\n  };\n\n  Animation.prototype.pause = function () {\n    if (!this._paused) {\n      this._pauseStart = getTime();\n      this._paused = true;\n    }\n  };\n\n  Animation.prototype.resume = function () {\n    if (this._paused) {\n      this._pausedTime += getTime() - this._pauseStart;\n      this._paused = false;\n    }\n  };\n\n  Animation.prototype.clear = function () {\n    var clip = this._head;\n\n    while (clip) {\n      var nextClip = clip.next;\n      clip.prev = clip.next = clip.animation = null;\n      clip = nextClip;\n    }\n\n    this._head = this._tail = null;\n  };\n\n  Animation.prototype.isFinished = function () {\n    return this._head == null;\n  };\n\n  Animation.prototype.animate = function (target, options) {\n    options = options || {};\n    this.start();\n    var animator = new Animator(target, options.loop);\n    this.addAnimator(animator);\n    return animator;\n  };\n\n  return Animation;\n}(Eventful);\n\nexport default Animation;","map":{"version":3,"sources":["/home/rayce/Udatabase/study/ElectronicMall/BookVue/node_modules/zrender/lib/animation/Animation.js"],"names":["__extends","Eventful","requestAnimationFrame","Animator","getTime","Date","Animation","_super","opts","_this","call","_running","_time","_pausedTime","_pauseStart","_paused","stage","prototype","addClip","clip","animation","removeClip","_head","_tail","next","prev","addAnimator","animator","getClip","removeAnimator","update","notTriggerFrameAndStageUpdate","time","delta","nextClip","finished","step","ondestroy","trigger","_startLoop","self","start","stop","pause","resume","clear","isFinished","animate","target","options","loop"],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport Eventful from '../core/Eventful.js';\nimport requestAnimationFrame from './requestAnimationFrame.js';\nimport Animator from './Animator.js';\nexport function getTime() {\n    return new Date().getTime();\n}\nvar Animation = (function (_super) {\n    __extends(Animation, _super);\n    function Animation(opts) {\n        var _this = _super.call(this) || this;\n        _this._running = false;\n        _this._time = 0;\n        _this._pausedTime = 0;\n        _this._pauseStart = 0;\n        _this._paused = false;\n        opts = opts || {};\n        _this.stage = opts.stage || {};\n        return _this;\n    }\n    Animation.prototype.addClip = function (clip) {\n        if (clip.animation) {\n            this.removeClip(clip);\n        }\n        if (!this._head) {\n            this._head = this._tail = clip;\n        }\n        else {\n            this._tail.next = clip;\n            clip.prev = this._tail;\n            clip.next = null;\n            this._tail = clip;\n        }\n        clip.animation = this;\n    };\n    Animation.prototype.addAnimator = function (animator) {\n        animator.animation = this;\n        var clip = animator.getClip();\n        if (clip) {\n            this.addClip(clip);\n        }\n    };\n    Animation.prototype.removeClip = function (clip) {\n        if (!clip.animation) {\n            return;\n        }\n        var prev = clip.prev;\n        var next = clip.next;\n        if (prev) {\n            prev.next = next;\n        }\n        else {\n            this._head = next;\n        }\n        if (next) {\n            next.prev = prev;\n        }\n        else {\n            this._tail = prev;\n        }\n        clip.next = clip.prev = clip.animation = null;\n    };\n    Animation.prototype.removeAnimator = function (animator) {\n        var clip = animator.getClip();\n        if (clip) {\n            this.removeClip(clip);\n        }\n        animator.animation = null;\n    };\n    Animation.prototype.update = function (notTriggerFrameAndStageUpdate) {\n        var time = getTime() - this._pausedTime;\n        var delta = time - this._time;\n        var clip = this._head;\n        while (clip) {\n            var nextClip = clip.next;\n            var finished = clip.step(time, delta);\n            if (finished) {\n                clip.ondestroy();\n                this.removeClip(clip);\n                clip = nextClip;\n            }\n            else {\n                clip = nextClip;\n            }\n        }\n        this._time = time;\n        if (!notTriggerFrameAndStageUpdate) {\n            this.trigger('frame', delta);\n            this.stage.update && this.stage.update();\n        }\n    };\n    Animation.prototype._startLoop = function () {\n        var self = this;\n        this._running = true;\n        function step() {\n            if (self._running) {\n                requestAnimationFrame(step);\n                !self._paused && self.update();\n            }\n        }\n        requestAnimationFrame(step);\n    };\n    Animation.prototype.start = function () {\n        if (this._running) {\n            return;\n        }\n        this._time = getTime();\n        this._pausedTime = 0;\n        this._startLoop();\n    };\n    Animation.prototype.stop = function () {\n        this._running = false;\n    };\n    Animation.prototype.pause = function () {\n        if (!this._paused) {\n            this._pauseStart = getTime();\n            this._paused = true;\n        }\n    };\n    Animation.prototype.resume = function () {\n        if (this._paused) {\n            this._pausedTime += getTime() - this._pauseStart;\n            this._paused = false;\n        }\n    };\n    Animation.prototype.clear = function () {\n        var clip = this._head;\n        while (clip) {\n            var nextClip = clip.next;\n            clip.prev = clip.next = clip.animation = null;\n            clip = nextClip;\n        }\n        this._head = this._tail = null;\n    };\n    Animation.prototype.isFinished = function () {\n        return this._head == null;\n    };\n    Animation.prototype.animate = function (target, options) {\n        options = options || {};\n        this.start();\n        var animator = new Animator(target, options.loop);\n        this.addAnimator(animator);\n        return animator;\n    };\n    return Animation;\n}(Eventful));\nexport default Animation;\n"]},"metadata":{},"sourceType":"module"}